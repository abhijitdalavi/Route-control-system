{% extends 'base/base_list.html' %}
{% load staticfiles %}

{% block overview %}
<li><i class="fa fa-id-card-o" aria-hidden="true"></i>Conductores</li>
{% endblock%}

{% block btn-new %}
<i class="fa fa-plus table-btn-padding-right" aria-hidden="true"></i>
Nuevo Conductor
{% endblock %}

{% block url %}
{% url 'dashboard:conductor:conductor_new' %}
{% endblock %}

{% block table-head %}
<thead>
  <tr>
      <th data-field="state" data-checkbox="true"></th>
      <th data-halign="center" data-align="center" data-field="cedula"  data-sortable="true" >Cedula</th>
      <th data-halign="center" data-align="center" data-field="nombres" data-sortable="true">Nombres</th>
      <th data-halign="center" data-align="center" data-field="apellidos" data-sortable="true">Apellidos</th>
      <th data-halign="center" data-align="center" data-field="celular" data-sortable="true">Celular</th>
      <th data-halign="center" data-align="center" data-field="estado" data-sortable="true">Estado</th>
      <th data-halign="center" data-align="center" data-field="acciones">Acciones</th>
  </tr>
</thead>
{% endblock %}

{% block table-body %}
<tbody>
  {% if object_list %}
  {% for conductor in object_list %}
    <tr>
        <td></td>
        <td><a href="{% url 'dashboard:conductor:conductor_edit' conductor.cedula %}">{{ conductor.cedula }}</a></td>
        <td>{{ conductor.nombres }}</td>
        <td>{{ conductor.apellidos }}</td>
        <td>{{ conductor.celular }}</td>
        <td>{% if conductor.activo_inactivo %}Activo{% else %}Inactivo{% endif %}</td>
        <td>
          <div class="btn-group">
            <a class="btn btn-primary" href="{% url 'dashboard:conductor:conductor_edit' conductor.cedula %}"><i class="fa fa-pencil-square-o" aria-hidden="true"></i></a>
          </div>
          <div class="btn-group">
            <a onclick="change_status({{ conductor.cedula }}, '{{ csrf_token }}', '{% url 'dashboard:conductor:conductor_delete' %}', '{% url 'dashboard:conductor:conductor_list' %}')" class="btn btn-danger" data-toggle="modal" data-target="#modalEmergente"><i class="fa fa-ban" aria-hidden="true"></i></a>
          </div>
        </td>
    </tr>
  {% endfor %}
  {% else %}
    <h3 class="page-header"><i class="fa fa-laptop"></i> No hay registros</h3>
  {% endif %}
</tbody>

<ul class="pager">
	<li>
    	{% if page_obj.has_previous %}
       	 <a href="?page={{ page_obj.previous_page_number }}">Previous</a>
    	{% endif %}
    </li>
	<li>
    	{% if page_obj.has_next %}
     	 <a href="?page={{ page_obj.next_page_number }}">Next</a>
    	{% endif %}
    </li>
</ul>
</section>
{% endblock %}

{% block modal-title %}
<div class="modal-header">
  <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
  <h4 class="modal-title">Cambiar estado</h4>
</div>
{% endblock %}

{% block modal-footer %}
<div class="modal-footer">
  <button class="btn btn-danger" id="confirmarDelete">Confirmar</button>
  <a class="btn btn-default" href="">Cancelar</a>
</div>
{% endblock %}

{% block modal-body %}
<div class="modal-body">
  <h3>Est√° seguro que desea cambiar el estado del conductor?</h3>
</div>
{% endblock %}


{% block extrajs %}
<script src="{% static 'tenant/js/bootstrap-table.js'%}"></script>
<script>
  $( document ).ready(function() {
    $(".fixed-table-toolbar").append( '<div class="columns columns-left btn-group pull-left"><a class="btn btn-success" href="{% url 'dashboard:conductor:conductor_new' %}">Crear Conductor</a></div>' );
  });
</script>
<script>

  function get_cedula(cedula){
    $('#confirmarDelete').click(function(){
      var request = $.ajax({
          type: "POST",
          url: "{% url 'dashboard:conductor:conductor_delete' %}",
          data: {
              "csrfmiddlewaretoken": "{{ csrf_token }}",
              "identificadorC_id": cedula
          },
      });
      request.done(function(response) {
          if (response.delete){
            $('#modalEmergente').modal(response.class)
            location.href ="{% url 'dashboard:conductor:conductor_list' %}";
          }
      });
    });

  }



</script>
{% endblock %}
